package com.libo.servlet.wang;

import java.io.IOException;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.lib.service.publish.PublishService;
import com.lib.service.publish.PublishServiceImpl;
import com.libo.entity.Msg_manuscripts;

public class ConnectionServlet extends HttpServlet {
	public void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		doPost(request, response);
	}

	public void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		request.setCharacterEncoding("utf-8");
		response.setCharacterEncoding("utf-8");
		response.setContentType("text/html;charset=utf-8");
		// 分页大小
		int pageSize = 3;
		String type = request.getParameter("type");
		// 录用稿件
		
			Map<String, String> condition = new HashMap<String, String>();
			String name = request.getParameter("name");
			String number = request.getParameter("number");
			if (name != null && !("null".equals(name))
					&& !("".equals(name.trim()))) {
				condition.put("name", name);
			}
			if (number != null && !("null".equals(number))
					&& !("".equals(number.trim()))) {
				condition.put("number", number);
			}
			int page = Integer
					.parseInt(request.getParameter("page") == null ? "1"
							: request.getParameter("page"));
			PublishService ps = new PublishServiceImpl();

			List<Msg_manuscripts> msg = ps.queryManuscripts(page, pageSize,
					condition);
			int[] counts = ps.queryManuscriptsCount(pageSize, condition);
			int pageCount = counts[0];
			int count = counts[1];
			request.setAttribute("msg", msg);
			request.setAttribute("pageSize", pageSize);
			request.setAttribute("page", page);
			request.setAttribute("pageCount", pageCount);
			request.setAttribute("count", count);
			request.setAttribute("name", name);
			request.setAttribute("number", number);
			request.getRequestDispatcher("Journal/listinfo3.jsp").forward(
					request, response);
		

	}

}
